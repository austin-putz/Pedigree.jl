<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API Reference · Pedigree.jl</title><meta name="title" content="API Reference · Pedigree.jl"/><meta property="og:title" content="API Reference · Pedigree.jl"/><meta property="twitter:title" content="API Reference · Pedigree.jl"/><meta name="description" content="Documentation for Pedigree.jl."/><meta property="og:description" content="Documentation for Pedigree.jl."/><meta property="twitter:description" content="Documentation for Pedigree.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Pedigree.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Functions</span><ul><li><a class="tocitem" href="../stack_ancestors/">Stack Ancestors</a></li><li><a class="tocitem" href="../sort_ped/">Sort Pedigree</a></li><li><a class="tocitem" href="../renum_ped/">Renumber Pedigree</a></li><li><a class="tocitem" href="../makeA/">Make A Matrix</a></li></ul></li><li class="is-active"><a class="tocitem" href>API Reference</a><ul class="internal"><li><a class="tocitem" href="#Functions"><span>Functions</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API Reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/austin-putz/Pedigree.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/austin-putz/Pedigree.jl/blob/main/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API-Reference"><a class="docs-heading-anchor" href="#API-Reference">API Reference</a><a id="API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-Reference" title="Permalink"></a></h1><h2 id="Functions"><a class="docs-heading-anchor" href="#Functions">Functions</a><a id="Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Pedigree.makeA-Tuple{DataFrames.DataFrame}" href="#Pedigree.makeA-Tuple{DataFrames.DataFrame}"><code>Pedigree.makeA</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">makeA(ped::DataFrame)</code></pre><p>Create the additive relationship matrix (A matrix) using the tabular method.</p><p>This function creates the numerator relationship matrix, which represents the  additive genetic relationships between all individuals in the pedigree. The method used is the classic tabular method.</p><p><strong>Arguments</strong></p><ul><li><code>ped::DataFrame</code>: A DataFrame with 3 columns representing animal ID, sire ID, and dam ID. The IDs must be integers from 1 to n, with parents appearing before their offspring. Missing parents must be coded as 0.</li></ul><p><strong>Returns</strong></p><ul><li><code>Matrix{Float64}</code>: The additive relationship matrix (A), where element A[i,j] is the additive genetic relationship between individuals i and j.</li></ul><p><strong>Requirements</strong></p><ul><li>The pedigree must be sorted so that parents appear before their offspring</li><li>Animal IDs must be integers from 1 to n</li><li>Missing parents must be coded as 0</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using DataFrames
using Pedigree

# Create a sample pedigree (must be numeric and ordered 1 to n)
ped = DataFrame(
    animal = [1, 2, 3, 4, 5, 6], 
    sire   = [0, 0, 1, 1, 4, 5],
    dam    = [0, 0, 2, 0, 3, 2]
)

# Create the A matrix
A = makeA(ped)</code></pre><p><strong>Notes</strong></p><p>For large pedigrees, this may be memory intensive. The diagonal elements contain the inbreeding coefficients plus 1.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/austin-putz/Pedigree.jl/blob/8059044a689ff5fda3badb7a0a04a2ea96693c0b/src/makeA.jl#L15-L57">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Pedigree.renum_ped-Tuple{DataFrames.DataFrame}" href="#Pedigree.renum_ped-Tuple{DataFrames.DataFrame}"><code>Pedigree.renum_ped</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">renum_ped(ped::DataFrame)</code></pre><p>Renumber a pedigree from 1 to n and convert string IDs to integers.</p><p>This function takes a pedigree with string IDs and renumbers all animals from 1 to n, maintaining the pedigree relationships. It returns a DataFrame with both the new numeric  IDs and the original string IDs.</p><p><strong>Arguments</strong></p><ul><li><code>ped::DataFrame</code>: A DataFrame with at least 3 columns representing animal ID, sire ID, and dam ID.</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: A new DataFrame with 6 columns:<ol><li><code>RenumID</code>: Renumbered animal ID (1 to n)</li><li><code>SireRenumID</code>: Renumbered sire ID</li><li><code>DamRenumID</code>: Renumbered dam ID</li><li><code>animal</code>: Original animal ID</li><li><code>sire</code>: Original sire ID</li><li><code>dam</code>: Original dam ID</li></ol></li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using DataFrames
using Pedigree

# Create a sample pedigree
ped = DataFrame(
    animal = [&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;],
    sire = [&quot;0&quot;, &quot;0&quot;, &quot;B&quot;, &quot;B&quot;],
    dam = [&quot;0&quot;, &quot;0&quot;, &quot;A&quot;, &quot;C&quot;]
)

# Renumber the pedigree
renum_ped = renum_ped(ped)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/austin-putz/Pedigree.jl/blob/8059044a689ff5fda3badb7a0a04a2ea96693c0b/src/renum_ped.jl#L5-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Pedigree.sort_ped-Tuple{DataFrames.DataFrame}" href="#Pedigree.sort_ped-Tuple{DataFrames.DataFrame}"><code>Pedigree.sort_ped</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sort_ped(ped::DataFrame; maxrounds=1000)</code></pre><p>Sort a pedigree in ancestral order, ensuring parents appear before their offspring.</p><p>This function sorts the pedigree so that all ancestors appear before their descendants. It also adds any missing ancestors to the top of the pedigree with unknown parentage.</p><p><strong>Arguments</strong></p><ul><li><code>ped::DataFrame</code>: A DataFrame with at least 3 columns representing animal ID, sire ID, and dam ID.</li><li><code>maxrounds::Int=1000</code>: Maximum number of sorting iterations to perform before giving up.</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: A new DataFrame with the pedigree sorted in ancestral order.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using DataFrames
using Pedigree

# Create a sample pedigree
ped = DataFrame(
    animal = [&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;],
    sire = [&quot;0&quot;, &quot;0&quot;, &quot;B&quot;, &quot;B&quot;],
    dam = [&quot;0&quot;, &quot;0&quot;, &quot;A&quot;, &quot;C&quot;]
)

# Sort the pedigree
sorted_ped = sort_ped(ped)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/austin-putz/Pedigree.jl/blob/8059044a689ff5fda3badb7a0a04a2ea96693c0b/src/sort_ped.jl#L5-L35">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Pedigree.stack_ancestors-Tuple{DataFrames.DataFrame}" href="#Pedigree.stack_ancestors-Tuple{DataFrames.DataFrame}"><code>Pedigree.stack_ancestors</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">stack_ancestors(ped::DataFrame)</code></pre><p>Add missing ancestors to the pedigree.</p><p>This function finds all individuals that appear as parents but are not present in the pedigree as individuals. These missing ancestors are added to the top of the pedigree with unknown parentage (sire and dam set to &quot;0&quot;).</p><p><strong>Arguments</strong></p><ul><li><code>ped::DataFrame</code>: A DataFrame with at least 3 columns representing animal ID, sire ID, and dam ID.</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: A new DataFrame with ancestors added at the top, with each row containing an animal ID and its parents.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using DataFrames
using Pedigree

# Create a simple pedigree
ped = DataFrame(
    animal = [&quot;A&quot;, &quot;B&quot;, &quot;C&quot;],
    sire = [&quot;X&quot;, &quot;0&quot;, &quot;B&quot;],
    dam = [&quot;Y&quot;, &quot;0&quot;, &quot;A&quot;]
)

# Stack missing ancestors
stacked_ped = stack_ancestors(ped)</code></pre><p>In this example, &quot;X&quot; and &quot;Y&quot; would be added to the pedigree with &quot;0&quot; as their parents.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/austin-putz/Pedigree.jl/blob/8059044a689ff5fda3badb7a0a04a2ea96693c0b/src/stack_ancestors.jl#L16-L48">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../makeA/">« Make A Matrix</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Wednesday 23 April 2025 15:12">Wednesday 23 April 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
